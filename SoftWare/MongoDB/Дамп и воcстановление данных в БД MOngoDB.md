В MongoDB для дампа и восстановления данных используются две утилиты: `mongodump` и `mongorestore`. Это наиболее распространенные и рекомендуемые способы для создания резервных копий и переноса данных.

### Дамп данных (экспорт) с помощью `mongodump`

Утилита `mongodump` создает бинарный дамп содержимого базы данных, который затем может быть использован для восстановления.
- **Дамп всей БД:**
```bash
    mongodump --db <имя_БД> --out <папка_назначения>    
```
Это создаст папку с именем `имя_БД` внутри `папка_назначения`, где будут храниться файлы `.bson` для каждой коллекции и файл `metadata.json`.
    
- **Дамп конкретной коллекции:**   
```bash
    mongodump --db <имя_БД> --collection <имя_коллекции> --out <папка_назначения>
```
    
- **Подключение к удаленному серверу:**
```bash
    mongodump --host <хост> --port <порт> --db <имя_БД> --out <папка_назначения>
```
    
Для удаленного дампа необходимо указать хост и порт. При необходимости можно добавить опции `--username` и `--password`.

**Пример:** Чтобы сделать дамп базы данных `mydatabase` в папку `backup` на рабочем столе, используется команда:
```bash
mongodump --db mydatabase --out ~/Desktop/backup
```


### **Восстановление данных (импорт) с помощью `mongorestore`**

Утилита `mongorestore` восстанавливает данные из дампа, созданного с помощью `mongodump`.

- **Восстановление всей БД:**
```bash
    mongorestore --db <имя_БД> <папка_с_дампом>
```    
Команда восстановит все коллекции из указанной папки в базу данных `имя_БД`. Если база данных не существует, MongoDB создаст её.
    
- **Восстановление конкретной коллекции:**
```bash
    mongorestore --db <имя_БД> --collection <имя_коллекции> <папка_с_дампом>/<имя_БД>/<имя_коллекции>.bson
```
    
- **Восстановление в другую БД:**
```bash
    mongorestore --nsFrom '<старая_БД>.*' --nsTo '<новая_БД>.*' <папка_с_дампом>
```
Этот способ позволяет восстановить данные из одного дампа в другую базу данных.
    
**Пример:** Чтобы восстановить дамп из папки `backup` в базу данных `myrestored_db`, используется команда:
```bash
mongorestore --db myrestored_db ~/Desktop/backup/mydatabase
```



### **Важные замечания:**

- Утилиты **`mongodump`** и **`mongorestore`** включены в пакет MongoDB Database Tools. Если у вас их нет, их нужно установить отдельно.
- Эти утилиты создают **бинарные дампы**, которые включают BSON-представление документов и метаданные. Это отличается от импорта/экспорта в JSON или CSV, которые выполняются с помощью `mongoexport` и `mongoimport`.
- При восстановлении данных с помощью `mongorestore` утилита **удаляет все данные** в коллекции, если не использовать опцию `--drop`.

Официальный образ `mongo` содержит только серверную часть — `mongod`, которая необходима для запуска самой базы данных. Утилиты для работы с командной строкой, такие как `mongodump`, `mongorestore`, `mongoexport`, `mongoimport` и `mongosh`, должны быть установлены отдельно.

### Как получить доступ к утилитам при работе с docker-контейнерами?

Для работы с `mongodump` и `mongorestore` у вас есть два основных способа:
1. **Использовать отдельный Docker-образ с инструментами.** MongoDB предоставляет официальный образ `mongodb/mongodb-database-tools`, который можно запустить для выполнения операций дампа или восстановления, подключаясь к вашему контейнеру с `mongod`.
2. **Установить утилиты на хост-машину.** Вы можете скачать и установить MongoDB Database Tools на свою локальную машину, чтобы запускать команды, подключаясь к Docker-контейнеру через сеть.
    
Первый способ является более предпочтительным, так как он сохраняет "контейнерную" идеологию: все зависимости и инструменты находятся в своих контейнерах, что упрощает управление.