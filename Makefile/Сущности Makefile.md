#### **Правила (Rules)**

Определяют, **как** и **при каких условиях** выполнять команды.  
Состоят из трех компонентов:
- **Цель (Target):** Имя задачи или файла, который нужно создать.  
    Пример: `build`, `clean`, `app.exe`.
- **Зависимости (Dependencies):** Файлы или другие цели, от которых зависит выполнение текущей цели.  
    Пример: `build: main.go` (цель `build` зависит от файла `main.go`).
- **Команды (Commands):** Действия, которые выполняются для достижения цели.  
    Пример:
    ```make
    build:  
    go build -o app.exe main.go  
	```


#### **2. Переменные (Variables)**

Используются для хранения значений, которые можно повторно использовать в Makefile.

- **Назначение:** Упрощение поддержки, уменьшение дублирования кода.
- **Пример:**
	```make
	BIN_NAME = app.exe  
	build:  
    go build -o $(BIN_NAME)  
	```
- **Типы переменных:**
     - Простые: `VAR = value` (значение вычисляется при каждом обращении).  
    - Присвоение с немедленным вычислением: `VAR := value`.
    - Условное присвоение: `VAR ?= default_value` (устанавливается, если переменная не определена).

#### **3. Директивы (Directives)**

Специальные инструкции для управления процессом обработки Makefile.
- **`.PHONY`:** Помечает цель как "не связанную с файлом".  
    Пример: `.PHONY: clean`.
- **`include`:** Включает содержимое другого файла в Makefile.  
    Пример: `include config.mk`.
- **`.DEFAULT_GOAL`:** Указывает цель по умолчанию (если не задана явно).  
    Пример: `.DEFAULT_GOAL = build`.


#### **4. Шаблонные правила (Pattern Rules)**

Позволяют создавать обобщенные правила для обработки групп файлов.
- **Назначение:** Автоматизация компиляции, генерации файлов.
- **Пример:**
	```make
	%.o: %.c  
    gcc -c $< -o $@  
	```
	Здесь `%.o` — шаблон для всех `.o`-файлов, `$<` — имя первой зависимости, `$@` — имя цели.

#### **5. Автоматические переменные (Automatic Variables)**

Специальные переменные, доступные внутри команд правил.
- **`$@`:** Имя текущей цели.
- **`$<`:** Имя первой зависимости.
- **`$^`:** Список всех зависимостей.
- **`$?`:** Зависимости, которые новее цели.
- **Пример:**
	```make
	build: main.go utils.go  
    go build -o $@ $^  
	```

#### **6. Условные конструкции (Conditionals)**

Позволяют выполнять команды в зависимости от условий.
- **Назначение:** Кросс-платформенная поддержка, гибкая настройка. 
- **Пример:**
	```makefile
	ifeq ($(OS), Windows_NT)  
	    RM = del  
	else  
	    RM = rm -f  
	endif  
	
	clean:  
	    $(RM) *.exe  
	```

#### **7. Комментарии (Comments)**

Используются для пояснения логики Makefile.
- **Синтаксис:** Начинаются с символа `#`. 
- **Пример:**
	```makefile
	# Сборка проекта  
	build:  
	    go build -o app.exe  
	```

### Систематизация сущностей

|**Категория**|**Сущности**|**Назначение**|
|---|---|---|
|**Основные элементы**|Правила (цели, зависимости, команды)|Определяют логику сборки и выполнения задач.|
|**Управление**|Директивы (`.PHONY`, `include`)|Контролируют поведение `make`, включают внешние файлы, объявляют фиктивные цели.|
|**Переиспользование**|Переменные|Упрощают настройку и уменьшают дублирование кода.|
|**Автоматизация**|Шаблонные правила, автоматические переменные|Позволяют создавать универсальные правила для групп файлов.|
|**Логика**|Условные конструкции|Добавляют ветвление в зависимости от условий (ОС, переменных окружения).|
|**Документация**|Комментарии|Поясняют работу Makefile.|

### Пример Makefile с использованием всех сущностей
```makefile
# Переменные
BIN = app.exe
SRC = $(wildcard *.go)

# Директива: цель по умолчанию
.DEFAULT_GOAL = build

# Правило с зависимостями и автоматическими переменными
$(BIN): $(SRC)
    go build -o $@ $^

# Шаблонное правило (пример для C)
%.o: %.c
    gcc -c $< -o $@

# Условная конструкция
ifeq ($(OS), Windows_NT)
    RM = del
else
    RM = rm -f
endif

# Фиктивная цель
.PHONY: clean
clean:
    $(RM) $(BIN)

# Комментарий для запуска
# Используйте: make build, make clean
```

