**Фильтр Блума** — это вероятностная структура данных, предназначенная для быстрой проверки, принадлежит ли элемент множеству. Он может **точно утверждать, что элемент _не_ принадлежит множеству**, но **может ошибаться при утверждении, что элемент _принадлежит_ множеству** (ложноположительные срабатывания). Ложноотрицательных срабатываний **не бывает**.


Готовая реализация фильтра [`github.com/bits-and-blooms/bloom`](https://github.com/bits-and-blooms/bloom)`




### Мотивация использования фильтров Блума
Фильтр Блума используется, когда нужно:
- **Быстро проверить наличие элемента** без хранения самих элементов (экономия памяти + скорость). Спам-фильтры (быстро исключать заведомо нежелательные адреса).
- **Уменьшить количество обращений** к более дорогим структурам (например, к базе данных, диску). Кэширование (например, в **Bigtable**, **Cassandra**, **Redis**).
- Поддерживать **асимптотически быстрые операции** (`O(k)` на добавление и проверку, где `k` — число хеш-функций).


### API  фильтров блума
- **Добавить снимок на элемент**: `Add(<element>)`
- **проверить наличие элемента по наличию снимка**: `Test(<element>) bool`( `Check(<elemnat>) bool`, `MinghtContain(<element>) bool` и т.д.). Допустим возврат ложно-положительного значения.



### Фильтр Блума состоит из:
- **Битового массива** длины `m` (все биты изначально `0`).
-  **k независимых хеш-функций**, каждая из которых отображает элемент в индекс `[0, m-1]`.


### Принцип работы фильтра Блума

**Добавление элемента**:
- Для элемента `x` вычисляются `k` хешей.
- Устанавливаются в `1` биты по соответствующим индексам.

**Проверка наличия элемента**:
- Для элемента `x` вычисляются те же `k` хешей.
- Если **все соответствующие биты = 1**, фильтр говорит: «ВОЗМОЖНО, есть».
- Если **хотя бы один бит = 0**, фильтр точно говорит: «НЕТ».


### Основные характеристики
| Параметр                                   | Обозначение | Комментарий                                                                                                                        |
| ------------------------------------------ | ----------- | ---------------------------------------------------------------------------------------------------------------------------------- |
| Количество элементов                       | `n`         | Оцениваемое число элементов для добаления в фильтр Блума                                                                           |
| Размер битового массива                    | `m`         | Чем больше — тем ниже вероятность ложных срабат ваний. Чем `m` больше значения `n` тем меньше промахов.<br>`m = −n*ln(p​)/(ln2)^2` |
| Число хеш-функций                          | `k`         | Оптимальное значение. Рассчитывается по формуле: <br>`k = (m / n) * ln(2)`                                                         |
| Ожидаемая вероятность ложного срабатывания | `p`         | Пример: <br>`p = (1 - e^(-kn/m))^k`                                                                                                |
| Пространственная сложность                 | `O(m)`      | Намного меньше, чем хранение самих элементов                                                                                       |
| Временная сложность                        | `O(k)`      | Очень быстро                                                                                                                       |
